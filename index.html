<!DOCTYPE html>
<html>
  <head>

    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0px; padding: 0px }
      #map { height: 100% }
    </style>

    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"
        type="text/javascript" charset="UTF-8"></script>

    <script type="text/javascript">

    var map;
    var latlng = new Array();
    var zoom = new Array();
    var marker;
var shareable=0;
    function init() {
      latlng[0] = new google.maps.LatLng();
      zoom[0] = "8";
       latlng[1] = new google.maps.LatLng(35.7, 51.39999999999998);
       zoom[1] = "8";
      latlng[2] = new google.maps.LatLng(32.6546275, 51.66798259999996);
       zoom[2] = "8";  
      latlng[3] = new google.maps.LatLng(32.6546275, 51.66798259999996);
       zoom[3] = "8";  
      latlng[4] = new google.maps.LatLng(32.6546275, 51.66798259999996);
       zoom[4] = "8";  
      latlng[5] = new google.maps.LatLng(32.6546275, 51.66798259999996);
       zoom[5] = "8";                                


      // Map MapOptions
      var opts = {
        zoom: 11,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        center: new google.maps.LatLng(36, 52) 
      };

      // getElementById("map")の"map"は、body内の<div id="map">より
      map = new google.maps.Map(document.getElementById("map"), opts);




      var sel = document.getElementById("myselect");
      sel.index = 1;
      map.controls[google.maps.ControlPosition.TOP_CENTER].push(sel);

      google.maps.event.addDomListener(sel, 'click', function() {
        });


      pForm = document.getElementById("pForm");
      pForm.index = 1;
      map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(pForm);


      info = document.getElementById("info");
      info.index = 1;
      map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(info);



///
google.maps.event.addListener(map,'bounds_changed',function() {
var zoom = map.getZoom()
var latt = map.getCenter().lat();
var lngg = map.getCenter().lng();
  document.getElementById("info").innerHTML ="zoom level: " + zoom + "<br>lat: "+ latt +"<br>lng: "+ lngg ;
});


google.maps.event.addListener(map, "rightclick", function(event) {
    var lat = event.latLng.lat();
    var lng = event.latLng.lng();

      map.setCenter(new google.maps.LatLng(lat, lng));
});


google.maps.event.addListener(map, "click", function(event) {
    if (shareable==1) {
share2(event.latLng);
}
});

    }
///////// ini



function share() {
if (shareable==0){
document.getElementById("share").style.backgroundColor="blue";
 shareable=1;
 var location;
 location= map.getCenter();


        marker = new google.maps.Marker({
            position: location,
            map: map,
            draggable: true,
             animation: google.maps.Animation.DROP
        });
  	var infowindow = new google.maps.InfoWindow({
  	  content: 'this is your link to here: <br><input type="text" name="testField" maxlength="100" size=100% value=http://kmzdan.ugig.ir/iindex.php?y=' + location.lat() + '&x=' + location.lng() +'>'
	  });
  infowindow.open(map,marker);

}
else
{
 marker.setMap(null); 
shareable=0;
document.getElementById("share").style.backgroundColor="red";
}
}






function share2(location) {

    if (marker) {
 	marker.setMap(null); 


        marker = new google.maps.Marker({
            position: location,
            map: map,
             animation: google.maps.Animation.DROP
        });
  	var infowindow = new google.maps.InfoWindow({
  	  content: 'this is your link to here: <br><input type="text" name="testField" maxlength="100" size=100% value=http://kmzdan.ugig.ir/iindex.php?y=' + location.lat() + '&x=' + location.lng() +'>'
	  });
  infowindow.open(map,marker);
    } else {

}
}





function prompt() {
var pf = document.getElementById( 'pForm' );
pf.style.display = 'block'; 
}
function ddprompt() {
var pf = document.getElementById( 'pForm' );
pf.style.display = 'none'; 
}


function goto() {
var f = document.getElementById( 'pForm' );
var lat = f.lat.value;
var lng = f.lng.value;
f.style.display = 'none';
           map.setCenter(new google.maps.LatLng(lat, lng));
          map.setZoom(14); 
}





function showinfo() {
if(document.getElementById("info").style.display == 'none') 
{
document.getElementById("info").style.display = 'block';
document.getElementById("showinfo").style.backgroundColor="blue";
}
else
{
  document.getElementById("info").style.display = 'none';
document.getElementById("showinfo").style.backgroundColor="red";
}
}






function geolocation(){

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var coords = new google.maps.LatLng(latitude, longitude);
            map.setCenter(coords);
            map.setZoom(17);

    });
} else {
        alert("Geolocation API is not supported in your browser.");
        }

;}



function sethome() {
window.newcenter = map.getCenter();  // global variable
window.newzoom = map.getZoom();   // global variable



  }


function home() {
if( typeof window.newcenter !== "undefined" ){   // if is set


            map.setCenter(window.newcenter);
            map.setZoom(window.newzoom);
}
else{
            map.setCenter(new google.maps.LatLng(36, 52));
            map.setZoom(11);
}
  }


function zoomp(){map.setZoom( map.getZoom()+1 );}
function zoomn(){map.setZoom( map.getZoom()-1 );} 

    function aaa() {
  map.setZoom(9);
    }

    function iran() {
   map.setCenter(new google.maps.LatLng(32, 55.1));
 map.setZoom(5);
    }

    function selectchanged() {

      var sl = document.getElementById("sel");
      var value = sl.options[sl.selectedIndex].value;
       if (value > 0){
      map.setCenter(latlng[value]);
      map.setZoom(zoom[value]);
       }
    }
    </script>
  </head>

  <body onload="init()">
    <div id="map"></div>

    <div id="myselect">
    <table id="selk" >
<td id="a" bgcolor="green" onClick="aaa()"> "Aaaaaa" </td>
<td id="iran" bgcolor="red" onClick="iran()"> iran </td>
<td id="goto_akiba" bgcolor="yellow" onClick="prompt()"> goto_akiba</td>
<td id="d" bgcolor="red" onClick="zoomp()"> zoom + </td>
<td id="e" bgcolor="green" onClick="zoomn()"> zoom - </td>
<td id="f" bgcolor="red" onClick="home()"> home </td>
<td id="f" bgcolor="red" onClick="sethome()"> sethome </td>
<td id="f" bgcolor="red" onClick="geolocation()"> geolocation </td>
<td id="showinfo" bgcolor="red" onClick="showinfo()"> showinfo</td>
<td id="share" bgcolor="red" onClick="share()"> share</td>
<td>
    <select id="sel" onChange="selectchanged()">
      <option value="0" selected>ostan</option>
      <option value="1" >tehran</option>
      <option value="2">esfahan</option>
      <option value="3">御徒町</option>
      <option value="4">巣鴨</option>
    </select>
</td>

</table>
<div id="info" style=" display:none ;background-color: yellow; border:2px solid blue; padding:2px;width:12%;font-size: 100%;text-align:left;height:auto;"
></div>

<form id="pForm" style="

display:none;background-color: yellow;
border:2px solid blue;
padding:8px;width:auto;text-align:center;height:auto;">
lat: <input type="text" name="lat" id="lat" /><br><br>
lng: <input type="text" name="lng" id="lng" /><br><br>
<input type="button" value="OK" onclick="goto()" />
<input type="button" value="cancel" onclick="ddprompt()" />
<div id="latlng">goto lat lng</div>
</form>


  </body>

</html>
